
\chapter{Εισαγωγή} 

\label{chapter:intro}

\section{Υπολογιστική ρευστομηχανική}

Σε πολλούς τομείς της μηχανικής και της επιστήμης είναι απαραίτητη η πρόβλεψη της συμπεριφοράς ενός ρευστού υπό δεδομένες συνθήκες.
Παρόλο που η συμπεριφορά των ρευστών για τις περισσότερες εφαρμογές περιγράφεται με αρκετά καλή προσέγγιση από της εξισώσεις που προκύπτουν από την μηχανική συνεχούς μέσου, η αναλυτική επίλυση αυτών των εξισώσεων είναι εφικτή μόνο σε ιδιαίτερα απλές γεωμετρίες ή/και μετά από μία σειρά παραδοχών που τις απλοποιούν.

Για την γενική περίπτωση των προβλημάτων που δεν επιδέχονται απλοποιήσεις τέτοιου είδους, παραμένουν δύο επιλογές για την εύρεση του ζητούμενου αποτελέσματος. Η πρώτη είναι η εκτέλεση κάποιου πειράματος, π.χ. σε μία αεροσείραγγα. Αυτή η προσέγγιση, αν και μας επιτρέπει να πάρουμε αρκετά ακριβείς απαντήσεις καθώς δεν χρειάζεται να κάνουμε παραδοχές όσον αφορά την μοντελοποίηση του ρευστού, συνήθως είναι συγκριτικά ακριβότερη οπότε είναι εφικτή μόνο για έναν περιορισμένο αριθμό δοκιμών. Παράλληλα, οι περιορισμοί των συσκευών μέτρησης περιορίζουν τα δεδομένα που μπορούμε να λάβουμε.

Η δεύτερη επιλογή είναι η εκτέλεση μίας υπολογιστικής μελέτης σχετικά με το πρόβλημα. Με την άφιξη οικονομικών και ισχυρών ηλεκτρονικών υπολογιστών διαθέσιμων σε μεμονομένους χρήστες και μικρούς οργανισμούς, αυτή η επιλογή καθίσταται ολοένα και ελκυστικότερη, δεδομένων των περιορισμών κόστους που συνήθως συνοδεύουν μελέτες ανάπτυξης προϊώντων και επιστημονικές μελέτες. Οι υπολογιστικές μελέτες μπορούν να γίνουν με διάφορες τεχνικες, που παρέχουν διαφορετικούς συμβιβασμούς ανάμεσα στο υπολογιστικό κόστος και την ακρίβεια των αποτελεσμάτων.

\section{Παραλληλοποίηση υπολογισμών με κάρτες γραφικών}

Τα περισσότερα προβλήματα υπολογιστικής ρευστομηχανικής, όπως και πληθώρα άλλων προβλημάτων επιστημονικών υπολογισμών, απαιτούν την επανάληψη μίας σειράς βασικών υπολογισμών (iteration) έως την επίτευξη κάποιου κριτηρίου σύγκλισης η τερματισμού του υπολογιστικού πειράματος.
Επιπρόσθετα, πολλές από τις αριθμητικές μεθόδους που χρησιμοποιούνται επιδέχονται σημαντική επιτάχυνση με την παραληλλοποίηση των υπολογισμών τους.

Ο κλασικός τρόπος επίτευξης παραλληλισμού τέτοιου είδους είναι ο καταμερισμός του προβλήματος σε ένα σύνολο υπολογιστών (cluster), εκ των οποίων ο καθένας επιλύει ένα κομμάτι του προβλήματος και επικοινωνεί με τους υπόλοιπους μέσω κάπου προτοκόλου, όπως το δημοφιλές Message Passing Interface (MPI). Αυτή η προσέγγιση, εάν και σε συνδιασμό με της παρακάτω τεχνικές επιτρέπει επίτευξη πολύ μεγάλης κλίμακας (scaling), από μόνη της έχει το μειονέκτημα του υψηλού κόστος ανά παράλληλη μονάδα επεξεργασίας, καθώς και την χρονοβόρα μεταφορά δεδομένων από τον έναν υπολογιστή στον άλλον.

Μία πιο αποδοτική προσέγγιση είναι ο συνδιασμός πολλαπλών πυρήνων επεξεργασίας σε ένα ολοκληρωμένο κύκλωμα, η χρήση δηλαδή πολυπήρηνων επεξεργαστών (multi-core processors). Το κόστος ανά υπολογιστικό πυρήνα είναι σημαντικό μικρότερο σε αυτήν την περίπτωση, ενώ ο κάθε πυρήνας έχει πρόσβαση στην κοινή μνήμη, η προσπέλαση της οποίας είναι αρκετές τάξης μεγέθους γρηγορότερη από την λήψη δεδομένων από άλλους υπολογιστικούς κόμβους, ακόμα και με γρήγορες τεχνολογίες δικτύωσης όπως το InfiniBand.

Τα τελευταία χρόνια, ένας εναλλακτικός τρόπος επιτάχυνσης υπολογισμών με παραλληλοποίηση ήρθε από τον κλάδο των γραφικών υπολογιστών.
Πιο συγκεκριμένα, οι κατασκευαστές καρτών γραφικών, στην προσπάθειά τους να επιτύχουν καλύτερη απόδοση στον σχεδιασμό γραφικών (rendering), κατασκέυασαν επεξεργαστές που μπορούν να επεξεργαστούν έναν μεγάλο αριθμό δεδομένων την ίδια χρονική στιγμή.
Αυτό το μοντέλο υπολογισμών είναι αρκετά χρήσιμο στην γραφική υπολογιστών καθώς σε κάθε καρέ (frame), χρειάζεται να υπολογιστεί το χρώμα για κάθε εικονοστοιχείο (pixel), το οποίο συνήθως προκύπτει ως αποτέλεσμα αλγορίθμων που είναι παρόμοιοι για έναν μεγάλο αριθμό εικονοστοιχείων.
Πέρα από την γραφική όμως, τέτοιου είδους παραλληλισμός (τύπου SIMD όπως θα δούμε σε επόμενο κεφάλαιο), έχει πολλές εφαρμογές σε διάφορους τομείς, με δύο βασικούς να είναι οι επιστημονικοί υπολογισμοί και η εκαίδευση και χρήση νευρωνικών δικτύων σε συστήματα μηχανικής μάθησης (machine learning).

\section{Γλώσσα προγραμματισμού Julia}

Η Julia είναι μία γλώσσα προγραμματισμού της οποίας ο κύριος στόχος είναι η επίλυση του λεγόμενου "προβλήματος των 2 γλωσσών" \cite[p.~67]{Bezanson2017}, το πρόβλημα δηλαδή της αναγκαστικής επιλογής ανάμεσα σε μία γρήγορη γλώσσα χαμηλού επιπέδου (π.χ. C++, Fortran) και μία αργή γλώσσα υψηλού επιπέδου (π.χ. Python).
Η επίλυση αυτού του προβλήματος επιτρέπει σε ερευνητές και μηχανικούς να γράψουν το πρόγραμμά τους μονάχα μία φορά, σε μία γλώσσα η οποία παρέχει εκφραστικότητα υψηλού επιπέδου και την οποία μπορούν να γράψουν και άτομα χωρίς εκτεταμένες γνώσεις προγραμματισμού, ακολουθώντας μερικούς απλούς κανόνες μπορεί να παρέχει απόδοση συγκρίσιμη με γλώσσες χαμηλού επιπέδου.

Η τακτική που ακολουθεί η Julia για τον συνδιασμό αυτών των δύο φαινομενικά ασύμβατων απαιτήσεων, είναι η μεταγλώττιση του κώδικα αμέσως πριν την εκτέλεσή του (JIT compilation), καθώς και η δυνατότητα συγγραφής προγραμμάτων με όσον τον δυνατό γίνεται πιο γενικό τρόπο, γεγονός που επιτρέπει τον εύκολο συνδιασμό τους.

Όπως θα δούμε και στην συνέχεια, το στυλ προγραμματισμού της Julia ταιριάζει αρκετά στις ανάγκες του προγραμματισμού καρτών γραφικών \cite{Besard2019}.
Η υποστήριξη προγραμματισμού καρτών γραφικών παρέχεται από τα πακέτα της ομάδας JuliaGPU: για τις κάρτες γραφικών της NVIDIA το CUDA.jl (πρώην CUDAdrv.jl, CUDAnative.jl, και CuArrays.jl) \cite{Besard2018}, για αυτές της AMD το AMDGPU.jl, και για τους επιταχυντές της Intel το oneAPI.jl.

\section{Στόχοι της διπλωματικής εργασίας}

Παρόλο που οι δυνατότητες προγραμματισμού καρτών γραφικών για επιστημονικούς υπολογισμούς είναι διαθέσιμοι εδώ και αρκετά χρόνια, τα πιο γνωστά εμπορικά πακέτα υπολογιστικής ρευστομηχανικής είτε αξιοποιούν επιτάχυνση με κάρτες γραφικών μόνο για τους επιλυτές γραμμικών συστημάτων τους (ANSYS Fluent, OpenFOAM), είτε δεν παρέχουν κάποια δυνατότητα επιτάχυνσης καθόλου (SU2 \cite{Palacios2013}).

Ο κύριος στόχος της παρούσας διπλωματικής εργασίας είναι να ερευνήσει κατά πόσο το νέο στυλ προγραμματισμού που παρέχεται από την Julia, σε συνδιασμό με τις δυνατότητες μοντέρνων καρτών γραφικών μπορεί να παρέχει μία πλατφόρμα για την επίλυση προβλημάτων υπολογιστικής ρευστομηχανικής, και συγκεκριμένα την επίλυση των εξισώσεων συμπιεστής ροής του Euler, η οποία είναι εύκολη στην χρήση και την τροποποίηση, αλλά παράλληλα εκμεταλλεύεται πλήρως τις δυνατότητες του διαθέσιμου υλικού και πετυχαίνει απόδοση συγκρίσιμη με αυτή των πλέον γνωστών πακέτων υπολογιστικής ρευστομηχανικής.

Αν και προσπάθειες σχεδίασης μίας γλώσσας προγραμματισμού συγκεκριμένα για παράλληλους υπολογισμούς έχουν γίνει στο παρελθόν (Futhark \cite{Henriksen2017}), καθώς και γλωσσών συγκεκριμένα για υπολογισμούς σε γεωμετρικά πλέγματα (meshes) για επίλυση μερικών διαφορικών εξισώσεων (PDEs) (Liszt), θεωρούμε ότι οι δυνατότητες σύνθεσης προγραμμάτων της Julia επιτρέπουν την επίτευξη ενός υψηλού επιπέδου εκφραστηκότητας χωρίς να απαιτούν την χρήση μίας γλώσσας DSL.

Υπάρχουν ήδη διάφορες προσπάθειες για την ανάπτυξη πακέτων επίλυσης PDE με Julia αλλά μέχρι στιγμής κανένα δεν υποστηρίζει μη δομημένα πλέγματα (unstructured meshes) τα οποία κατά βάσει χρησιμοποιούνται σε εφαρμογές μηχανολογίας, ενώ τα περισσότερα εστιάζουν σε γενικά μαθηματικά προβλήματα και δεν παρέχουν συναρτήσεις για την γρήγορα επίλυση προβλημάτων ρευστομηχανικής.

\section{Οργάνωση κειμένου}

Στο κεφάλαιο \ref{chapter:theory}, παρουσιάζουμε εν συντομία την αριθμητική μέθοδο που υλοποιεί το πακέτο της εργασίας, και την εφαρμογή αυτής της μεθόδου σε προβλήματα ρευστομηχανικής.
Στην συνέχεια, το κεφάλαιο \ref{chapter:julia-diffeq}, επιδυκνείουμε τις δυνατότητες της γλώσσας προγραμματισμού Julia, την καταλληλότητά της για την υλοποίηση αριθμητικών αλγορίθμων, τα εργαλεία που υπάρχουν ήδη για την επίλυση διαφορικών εξισώσεων, ενώ επίσης δίνουμε μία πολύ εποπτική σύνοψη της δυνατότητας προγραμματισμού καρτών γραφικών με το πακέτο CUDA.jl.

Το κεφάλαιο \ref{chapter:shockwave}, παρουσιάζει την δομή του πακέτου μας, τις συναρτήσεις και τις δομές δεδομένων που σχεδιάστηκαν για την επίλυση των προβλημάτων ρευστομηχανικής της εργασίας, καθώς και την χρήση αυτών για την επίλυση απλών παραδειγματικών προβλημάτων.
Τέλος, η μέθοδος επαλήθευσης της ορθότητας και μερικές μετρήσεις της ταχύτητας επίλυσης του επιλυτή της εργασίας δίνονται στο κεφάλαιο \ref{chapter:results}, μαζί με τελικές σκέψεις σχετικά με τους περιορισμούς αυτής της εργασίας και προτροπές για μελλοντική συνέχεια της ερευνητικής προσπάθειας της παρούσας εργασίας.

